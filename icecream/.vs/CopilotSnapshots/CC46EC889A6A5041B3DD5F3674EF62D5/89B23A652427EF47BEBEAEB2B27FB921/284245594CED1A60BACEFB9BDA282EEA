@model IEnumerable<icecream.Models.User>

@{
 ViewData["Title"] = "Users";
 Layout = "~/Views/Shared/_DashLayout.cshtml";
}

<style>
 .users-card {
 background: #fff;
 border-radius:12px;
 padding:1.25rem;
 box-shadow:06px18px rgba(37,44,97,0.06);
 border:1px solid rgba(33,37,41,0.04);
 }
 .users-header {
 display:flex;
 align-items:center;
 justify-content:space-between;
 gap:12px;
 margin-bottom:12px;
 }
 .user-avatar {
 width:40px;
 height:40px;
 border-radius:50%;
 display:inline-flex;
 align-items:center;
 justify-content:center;
 background:linear-gradient(135deg,#ff9a9e,#fad0c4);
 color:#fff;
 font-weight:700;
 margin-right:8px;
 }
 .table-responsive { overflow:auto; }
 .users-table th, .users-table td { vertical-align:middle; }
 .badge-status { padding:6px10px; border-radius:999px; font-size:0.85rem; }
 .badge-paid { background:#e6ffed; color:#1f7a3a; }
 .badge-unpaid { background:#fff4f4; color:#b02a37; }
 .action-btns a { margin-left:6px; }
 .search-input { max-width:340px; }
 /* Remove bullets from pagination if default CSS missing */
 .pagination { list-style:none; padding-left:0; display:flex; gap:.4rem; }
 .pagination .page-item .page-link { display:inline-block; padding:.375rem .6rem; border-radius:.375rem; border:1px solid rgba(0,0,0,0.08); background:#fff; color:#333; }
 .pagination .page-item.active .page-link { background:#f8f0f6; border-color:rgba(0,0,0,0.06); }

 @@media (max-width:575.98px) {
 .users-header { flex-direction:column; align-items:flex-start; gap:8px; }
 .search-input { width:100%; max-width:none; }
 }
</style>

<div class="container py-4">
 <div class="users-card">
 <div class="users-header">
 <div>
 <h3 style="margin:0;">Users <small class="text-muted">(@(Model?.Count() ??0))</small></h3>
 <div class="text-muted" style="font-size:0.9rem;">Manage registered users and membership details</div>
 </div>

 <div class="d-flex align-items-center gap-2">
 <form method="get" class="d-flex align-items-center">
 <input name="q" class="form-control form-control-sm search-input" placeholder="Search by name or email" />
 </form>
 @* <a asp-action="Create" class="btn btn-sm btn-primary"><i class="fas fa-user-plus"></i> Add User</a> *@
 </div>
 </div>

 <div class="table-responsive">
 <table class="table users-table table-hover">
 <thead>
 <tr>
 <th style="min-width:220px;">User</th>
 <th>Email</th>
 <th>Phone</th>
 <th>Membership</th>
 <th>Payment</th>
 <th>Created</th>
 <th style="width:140px; text-align:right;">Actions</th>
 </tr>
 </thead>
 <tbody>
 @if (Model != null && Model.Any())
 {
 foreach (var item in Model)
 {
 var initials = string.Join("", (item.FullName ?? "").Split(' ').Where(s => !string.IsNullOrWhiteSpace(s)).Select(s => s[0])).ToUpper();
 <tr>
 <td>
 <div class="d-flex align-items-center">
 <div class="user-avatar">@initials</div>
 <div>
 <div style="font-weight:600;">@item.FullName</div>
 <div class="text-muted" style="font-size:0.85rem;">@item.Address</div>
 </div>
 </div>
 </td>
 <td>
 <div>@item.Email</div>
 </td>
 <td>@item.Phone</td>
 <td>
 <div>@item.MembershipType</div>
 <div class="text-muted" style="font-size:0.85rem;">@String.Format(System.Globalization.CultureInfo.CurrentCulture,"{0:C}", item.MembershipAmount)</div>
 </td>
 <td>
 @if (!string.IsNullOrEmpty(item.PaymentStatus) && string.Equals(item.PaymentStatus, "Paid", StringComparison.OrdinalIgnoreCase))
 {
 <span class="badge-status badge-paid">Paid</span>
 }
 else
 {
 <span class="badge-status badge-unpaid">Pending</span>
 }
 </td>
 <td>@(item.CreatedAt.HasValue ? item.CreatedAt.Value.ToString("yyyy-MM-dd") : "-")</td>
 <td class="text-end action-btns">
 <a asp-action="Details" asp-route-id="@item.UserId" class="btn btn-sm btn-outline-primary" title="View"><i class="fas fa-eye"></i></a>
 @* <a asp-action="Edit" asp-route-id="@item.UserId" class="btn btn-sm btn-outline-secondary" title="Edit"><i class="fas fa-edit"></i></a> *@
 <a asp-action="Delete" asp-route-id="@item.UserId" class="btn btn-sm btn-danger" title="Delete"><i class="fas fa-trash"></i></a>
 </td>
 </tr>
 }
 }
 else
 {
 <tr>
 <td colspan="7" class="text-center text-muted">No users found.</td>
 </tr>
 }
 </tbody>
 </table>
 </div>

 <div class="d-flex justify-content-between align-items-center mt-3">
 <div class="text-muted">Showing @(Model?.Count() ??0) users</div>
 <nav aria-label="Page navigation">
 <ul class="pagination pagination-sm mb-0">
 <li class="page-item disabled"><a class="page-link">Previous</a></li>
 <li class="page-item active"><a class="page-link">1</a></li>
 <li class="page-item"><a class="page-link">2</a></li>
 <li class="page-item"><a class="page-link">Next</a></li>
 </ul>
 </nav>
 </div>
 </div>
</div>

@section Scripts {
 <script>
 // Simple client-side search (filter rows) — optional enhancement
 (function(){
 var input = document.querySelector('input[name="q"]');
 if(!input) return;
 input.addEventListener('input', function(e){
 var q = e.target.value.toLowerCase();
 var rows = document.querySelectorAll('.users-table tbody tr');
 rows.forEach(function(r){
 var text = r.innerText.toLowerCase();
 r.style.display = text.indexOf(q) === -1 ? 'none' : '';
 });
 });
 })();
 </script>
}
